---
title: "Rendu Travaux Pratiques 1"
output: html_notebook
---

** **

#### Règles

* 


** **


#### Exercice 1: Vecteurs, matrices, listes et fonctions 

* On considère la suite finie $x_i = \sin(i)$, $i = 1,\dots,n = 123$. Combien de termes de cette suite sont-ils plus grands que 1/2 ? 

```{r}
x <- sin(1:123)
sum(x > 1/2)
```


* On effectue un million de tirages de valeurs entre 1 et 12 de sorte que la probabilité de chaque valeur $i$ est proportionnelle à $1/i$. Calculer la fréquence de nombre pairs.

```{r}
x <- sample(1:12, 1000000, prob = 1/(1:12), replace = TRUE)
mean(x %% 2 == 0)
```



* A partir du tableau de données **BreastCancer** du package *mlbench*, créer une matrice où toutes les lignes du tableau ayant des valeurs manquantes sont enlevées **apply**, **anyNA**. Donner la moyenne de la 3e colonne de cette matrice. Combien de lignes contenaient des données manquantes ?


```{r}
library(mlbench)
data(BreastCancer)
boo <- apply(BreastCancer,1,anyNA)
mat <- data.matrix(BreastCancer[!boo,])
mean(mat[,3])
sum(boo)
```

* créer une fonction prenant en entrée un vecteur numerique et retournant une liste contenant sa moyenne et son ecart type. La fonction produit un message d'arrêt si l'entrée n'est pas numeric. (**function**, **is.numeric**, **stop**, **mean**, **sd**, **list**, **return**). 


```{r}
f <-function(x){
  if (!is.numeric(x)) stop("x n'est pas numeric \n")
  object <- list()
  return(object)
}

```


#### Exercice 2: Vecteurs, matrices, listes et fonctions 

* Calculer les valeurs propres de la matrice **C** definie ci-dessous. Justifier que **C** est bien une matrice de covariance (**eigen**). 

```{r}
C <- matrix(c(5, -1, -1, -1, 3, 1, -1, 1, 2), nrow  = 3)
C
eigen(C)
```

* Calculer la matrice $C^{-1}$ et vérifier que $C^{-1} = U \Lambda^{-1} U^T$, **solve**


#### Exercice 3: Distance de Mahanalobis 



* Calculer la valeur de la distance $d^2((3,2),0)$ pour la matrice {\bf C} définie ci-dessous

```{r}
C <- matrix(c(5, -1, -1, 1), nrow  = 2)
C
#d2_mahan( as.matrix(c(3,2)) , x0 = as.matrix(c(0,0)), C)  
```


* Soit {\bf x} un vecteur aléatoire de matrice de covariance $C$. La valeur moyenne de la distance de Mahanalobis au carré entre {\bf x} et sa moyenne dépend-elle de $C$.

```{r}
reponse <- F
reponse
```

* Pour les 3 points suivant calculer les distances de Mahanalobis aux deux classes et predire la classe
```{r}
x.test <- matrix(c(0.48, 1.71, 5.35, 4.26, -0.04, -0.99), nrow = 3) 
x.test
```


```{r}
d1 <- apply(x.test, 1, FUN = function(x) d2_mahan(x, x0 = x1))
d2 <- apply(x.test, 1, FUN = function(x) d2_mahan(x, x0 = x2))
apply(cbind(d1,d2), 1, which.min)
```


